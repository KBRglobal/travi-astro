---
import { t, changeLanguage } from "i18next";
import BaseLayout from "../../layouts/BaseLayout.astro";
import { languages, type Language } from "../../lib/i18n";

// Generate static paths for all languages
export async function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({
    params: { lang },
  }));
}

// Get current language from params
const { lang } = Astro.params as { lang: Language };

// Change language for this request
changeLanguage(lang);

// Test translations
const homeTitle = t("home.hero.title");
const navHome = t("nav.home");
const navAttractions = t("nav.attractions");
const navAbout = t("nav.about");
const navContact = t("nav.contact");
---

<BaseLayout title="i18n Test" lang={lang}>
  <div class="container max-w-4xl py-20">
    <h1 class="text-4xl font-bold mb-8">üåç i18n System Test</h1>

    <div class="space-y-6">
      <!-- Current Language -->
      <div class="p-6 border rounded-lg bg-primary/5">
        <h2 class="text-2xl font-semibold mb-2">Current Language</h2>
        <p class="text-lg">
          <span class="font-mono bg-primary/10 px-2 py-1 rounded">{lang}</span>
        </p>
      </div>

      <!-- Navigation Translations -->
      <div class="p-6 border rounded-lg">
        <h2 class="text-2xl font-semibold mb-4">Navigation Translations</h2>
        <ul class="space-y-2">
          <li><strong>Home:</strong> {navHome}</li>
          <li><strong>Attractions:</strong> {navAttractions}</li>
          <li><strong>About:</strong> {navAbout}</li>
          <li><strong>Contact:</strong> {navContact}</li>
        </ul>
      </div>

      <!-- Homepage Hero Translation -->
      <div class="p-6 border rounded-lg">
        <h2 class="text-2xl font-semibold mb-4">Homepage Hero Title</h2>
        <p class="text-xl">{homeTitle}</p>
      </div>

      <!-- RTL Test -->
      <div class="p-6 border rounded-lg">
        <h2 class="text-2xl font-semibold mb-4">RTL Test</h2>
        <p>
          <strong>Direction:</strong>
          <span class="font-mono bg-primary/10 px-2 py-1 rounded">
            {['ar', 'he', 'fa', 'ur'].includes(lang) ? 'RTL ‚Üê' : 'LTR ‚Üí'}
          </span>
        </p>
      </div>

      <!-- Language Switcher -->
      <div class="p-6 border rounded-lg">
        <h2 class="text-2xl font-semibold mb-4">Test Other Languages</h2>
        <div class="flex flex-wrap gap-2">
          {['en', 'he', 'ar', 'fr', 'de', 'es', 'ja', 'zh'].map((l) => (
            <a
              href={`/${l}/test-i18n`}
              class:list={[
                "px-4 py-2 rounded border transition-colors",
                l === lang
                  ? "bg-primary text-primary-foreground border-primary"
                  : "hover:bg-primary/10 border-border"
              ]}
            >
              {l.toUpperCase()}
            </a>
          ))}
        </div>
      </div>

      <!-- Back Home -->
      <div class="p-6 border rounded-lg bg-muted">
        <a
          href={`/${lang}`}
          class="inline-flex items-center text-primary hover:underline"
        >
          ‚Üê Back to Homepage
        </a>
      </div>
    </div>
  </div>
</BaseLayout>
